# ============================================================
# Kalshi Market Data Collector — Configuration
# ============================================================
#
# Adding a new city / market:
#   1. Add the series prefix to `event_series` below.
#   2. Add a MarketConfig entry in markets/registry.py.
#   3. Done — collector, synoptic listener, and bot all pick it up.
# ============================================================

kalshi:
  # API credentials: set via env vars KALSHI_API_KEY_ID and KALSHI_PRIVATE_KEY_PATH
  # (see .env.example in this directory)
  private_key_path: "/home/kaitores/.kalshi/kalshi_api_key.txt"

  base_url: "https://api.elections.kalshi.com/trade-api/v2"
  ws_url:   "wss://api.elections.kalshi.com/trade-api/ws/v2"

# Series prefixes to track (uppercase).  At startup each service queries the
# Kalshi API for currently-open events in each series and picks the active one
# automatically — no manual date updates needed.
#
# The market registry (markets/registry.py) maps each prefix to:
#   - Weather station IDs (ICAO, IATA, Synoptic push)
#   - Timezone (critical for determining local day / event ticker dates)
#   - City name
event_series:
  - "KXHIGHCHI"
  - "KXHIGHNY"

# ----------------------------------------------------------
# Snapshot collection (Kalshi collector)
# ----------------------------------------------------------
collection:
  # Baseline: snapshot every N seconds regardless of price activity.
  interval_seconds: 60

  # Spike detection: snapshot immediately when any contract's yes_bid, yes_ask,
  # or last_price moves by ≥ threshold cents since the *last snapshot*.
  spike_threshold_cents: 3

  # Min seconds between event-driven snapshots.
  spike_cooldown_seconds: 2

  # Max orderbook depth saved per side per contract per snapshot.
  # Set to 0 to save all levels.
  max_orderbook_depth: 5

  # Delta compression: write full orderbook baselines every N snapshots,
  # and only changed/removed levels in between (saves ~80-90% of OB rows).
  # Set to 1 to disable.
  baseline_every_n_snapshots: 60

# ----------------------------------------------------------
# Storage
# ----------------------------------------------------------
storage:
  # Relative to this config file's directory.
  data_dir: "data"

  # How often to flush in-memory buffers to parquet (seconds).
  flush_interval_seconds: 300

# ----------------------------------------------------------
# Synoptic Data (real-time weather ingest)
# ----------------------------------------------------------
# Stations are auto-derived from `event_series` via the market registry.
# Only override below if you need extra stations beyond those in the registry.
synoptic:
  # stations:           # (optional) override auto-derived list
  #   - KMDW1M
  #   - KNYC
  vars:
    - air_temp

# ----------------------------------------------------------
# Weather Bot
# ----------------------------------------------------------
bot:
  # Number of consecutive 1-minute ASOS observations required above trigger
  consecutive_obs: 2

  # Maximum price (cents) to pay for a "NO" contract (Kalshi settles at 100).
  max_price_cents: 95

  # Starting paper balance (cents). $1,000 = 100000.
  starting_balance_cents: 100000

# ----------------------------------------------------------
# LDM — Unidata Local Data Manager (optional, informational)
# ----------------------------------------------------------
ldm:
  hostname: "changeme.example.com"
  upstream: "idd.unidata.ucar.edu"
  feedtype: "IDS|DDPLUS"
  product_filter: "^S[AP]"
